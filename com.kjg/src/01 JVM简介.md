# JVM与class
JVM作为虚拟机是用来执行class文件的，也就是说JVM只处理class。Java也是通过**javac****编译器**编译成class文件，最终放入JVM里执行。同理kotlin、groovy等语言也是通过对应的编译器编译成class放入JVM内执行。所以从宏观的角度上看：JVM是一个平台、一个进程、一个执行器。

JVM作为一个**应用进程**直接运行在操作系统上，不同平台有不同实现的JVM，从而保证JVM支持的语言具有跨平台性（语言有跨平台性，但JVM没有）。

JVM也可以作为一个规范，实际上有多种不同实现的JVM（虽然它们的目标都是执行class文件），其中HotSpot VM是主流使用的JVM之一。

# JVM整体结构

![image](https://user-images.githubusercontent.com/48977889/149263129-9e96b53c-1ad4-4788-8274-4080e28ebff1.png)

## 类加载器子系统

将字节码文件加载进JVM的方法区、链接、初始化

## 运行时数据区

用来存放对象的数据，**是多个内存空间的整合**。

PC寄存器：每一个Java线程一份，用来存放线程下一个要执行的**JVM指令地址**。

虚拟机栈：每一个Java线程一份，虚拟机栈内包含：局部变量表、操作数栈、动态链接、方法返回地址。主要是用来执行线程的方法。

本地方法栈：每个Java线程各有一份，不同于虚拟机栈，它是本地方法调用的栈。

堆：对象存放的地方，也是最大的区域。

方法区：存放类信息、常量，主要是静态数据。只在HotSpot有。

## 执行引擎

主要和OS打交道，用来实际执行指令，包含字节码解释器、JIT、GC

总的来说在整个Java进程的生命周期中，先开启JVM，类加载器将class文件加载进运行时数据区，执行引擎操作数据区里的数据、执行指令，最终是落实到OS层面，由OS调度到CPU上执行。